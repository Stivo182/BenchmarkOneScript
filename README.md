
# BenchmarkOneScript

[![Release](https://img.shields.io/github/release/Stivo182/BenchmarkOneScript.svg)](https://github.com/Stivo182/BenchmarkOneScript/releases)
[![–ü–æ–∫—Ä—ã—Ç–∏–µ](https://sonar.openbsl.ru/api/project_badges/measure?project=benchmark&metric=coverage&token=sqb_3054e7cdc0478fa1fc9ec12e319b76086791667e)](https://sonar.openbsl.ru/dashboard?id=benchmark)

<div>
	<a href="docs/–ë—ã—Å—Ç—Ä—ã–π–°—Ç–∞—Ä—Ç.md">–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç</a>
	<span> ¬∑ </span>
	<a href="docs/README.md">–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</a>
	<span> ¬∑ </span>
	<a href="samples">–ü—Ä–∏–º–µ—Ä—ã</a>
</div>
</br>

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞ –Ω–∞ OneScript, –≤–¥–æ—Ö–Ω–æ–≤–ª—ë–Ω–Ω–∞—è [BenchmarkDotNet](https://github.com/dotnet/BenchmarkDotNet/), —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏–∏, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø–∞–º—è—Ç–∏ –∏ –≥–∏–±–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ—Å—Ç–æ–≤.


## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:** –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –∏–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –∫–æ–¥.
- **–ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã:** –∑–∞–ø—É—Å–∫ –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ —Ç–µ—Å—Ç–æ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ –≤—Ö–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–∞–º—è—Ç–∏:** –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∞–ª–ª–æ–∫–∞—Ü–∏–∏ –ø–∞–º—è—Ç–∏ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.
- **–ú–µ—Ç—Ä–∏–∫–∏:** –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (—Å—Ä–µ–¥–Ω–µ–µ, –º–∏–Ω–∏–º—É–º, –º–∞–∫—Å–∏–º—É–º), —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∏ –æ—à–∏–±–∫–∞, –æ–ø–µ—Ä–∞—Ü–∏–π –≤ —Å–µ–∫—É–Ω–¥—É (Op/s), –∫–≤–∞—Ä—Ç–∏–ª–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª–∏.
- **–û—Ç—á–µ—Ç—ã –≤ Markdown:** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü—ã —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

## 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
opm install benchmark
```

## 2. –°–æ–∑–¥–∞–Ω–∏–µ –±–µ–Ω—á–º–∞—Ä–∫–∞

–°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å —Å –º–µ—Ç–æ–¥–∞–º–∏, –ø–æ–º–µ—á–µ–Ω–Ω—ã–º–∏ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–µ–π `&–ë–µ–Ω—á–º–∞—Ä–∫`, –≥–¥–µ –∫–∞–∂–¥—ã–π –º–µ—Ç–æ–¥ —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Ç–µ—Å—Ç–∏—Ä—É–µ–º—É—é –ª–æ–≥–∏–∫—É. 
–í —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏ —Å—Ç—Ä–æ–∫ —á–µ—Ä–µ–∑ –æ–ø–µ—Ä–∞—Ç–æ—Ä `+` –∏ –º–µ—Ç–æ–¥ `–°—Ç—Ä–°–æ–µ–¥–∏–Ω–∏—Ç—å`:

```bsl
// –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è–°—Ç—Ä–æ–∫.os

&–ü–∞—Ä–∞–º–µ—Ç—Ä—ã(100, 1000)
–ü–µ—Ä–µ–º –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≠–∫—Å–ø–æ—Ä—Ç;
–ü–µ—Ä–µ–º –ü–æ–¥—Å—Ç—Ä–æ–∫–∞;

&–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–ü–∞–º—è—Ç–∏
–ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –ü—Ä–∏–°–æ–∑–¥–∞–Ω–∏–∏–û–±—ä–µ–∫—Ç–∞()
	–ü–æ–¥—Å—Ç—Ä–æ–∫–∞ = "–ü—Ä–æ—Å—Ç–æ —Ç–µ–∫—Å—Ç";
–ö–æ–Ω–µ—Ü–ü—Ä–æ—Ü–µ–¥—É—Ä—ã

&–ë–µ–Ω—á–º–∞—Ä–∫
&–≠—Ç–∞–ª–æ–Ω
–ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –û–ø–µ—Ä–∞—Ç–æ—Ä–°–ª–æ–∂–µ–Ω–∏—è() –≠–∫—Å–ø–æ—Ä—Ç
	–¢–µ–∫—Å—Ç = "";
	–î–ª—è –ù–æ–º–µ—Ä–ü–æ–¥—Å—Ç—Ä–æ–∫–∏ = 1 –ü–æ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¶–∏–∫–ª
		–¢–µ–∫—Å—Ç = –¢–µ–∫—Å—Ç + –ü–æ–¥—Å—Ç—Ä–æ–∫–∞;
	–ö–æ–Ω–µ—Ü–¶–∏–∫–ª–∞;
–ö–æ–Ω–µ—Ü–ü—Ä–æ—Ü–µ–¥—É—Ä—ã

&–ë–µ–Ω—á–º–∞—Ä–∫
–ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –ú–∞—Å—Å–∏–≤–ü–æ–¥—Å—Ç—Ä–æ–∫() –≠–∫—Å–ø–æ—Ä—Ç
	–ú–∞—Å—Å–∏–≤–ü–æ–¥—Å—Ç—Ä–æ–∫ = –ù–æ–≤—ã–π –ú–∞—Å—Å–∏–≤();
	–î–ª—è –ù–æ–º–µ—Ä–ü–æ–¥—Å—Ç—Ä–æ–∫–∏ = 1 –ü–æ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¶–∏–∫–ª
		–ú–∞—Å—Å–∏–≤–ü–æ–¥—Å—Ç—Ä–æ–∫.–î–æ–±–∞–≤–∏—Ç—å(–ü–æ–¥—Å—Ç—Ä–æ–∫–∞);
	–ö–æ–Ω–µ—Ü–¶–∏–∫–ª–∞;

	–¢–µ–∫—Å—Ç = –°—Ç—Ä–°–æ–µ–¥–∏–Ω–∏—Ç—å(–ú–∞—Å—Å–∏–≤–ü–æ–¥—Å—Ç—Ä–æ–∫);
–ö–æ–Ω–µ—Ü–ü—Ä–æ—Ü–µ–¥—É—Ä—ã
```
## 3. –ó–∞–ø—É—Å–∫ –±–µ–Ω—á–º–∞—Ä–∫–æ–≤

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–µ–Ω—á–º–∞—Ä–∫–∏ –æ–¥–Ω–∏–º –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–ø–æ—Å–æ–±–æ–≤:

**CLI:**

```bash
benchos run [FILE]
```

`FILE` - –∏–º—è —Ñ–∞–π–ª–∞ –∫–ª–∞—Å—Å–∞ –±–µ–Ω—á–º–∞—Ä–∫–æ–≤ –≤ —Ç–µ–∫—É—â–µ–º –∫–∞—Ç–∞–ª–æ–≥–µ, –ª–∏–±–æ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ –Ω–µ–º—É

**API:**

```bsl
#–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å benchmark
#–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å "."

–†–µ–∑—É–ª—å—Ç–∞—Ç = –ë–µ–Ω—á–º–∞—Ä–∫–∏–Ω–≥.–ó–∞–ø—É—Å—Ç–∏—Ç—å(–¢–∏–ø("–ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è–°—Ç—Ä–æ–∫"));
```

## 4. –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∞ –ø–æ–¥—Ä–æ–±–Ω–∞—è —Å–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞, –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω–∞—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ Markdown:

```
BenchmarkOneScript v0.1.0, OneScript v2.0.0.567-rc7-29039316, Microsoft Windows NT 10.0.20348.0 \
Intel Core i7-8700 CPU 3.20GHz (Max: 3.19GHz) (Coffee Lake), 1 CPU, 12 logical and 6 physical cores

| Method           | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ | Baseline |       Mean |      StdErr |   StdDev | Ratio |     Median |     Op/s |   Allocated |
|------------------|-----------:|----------|-----------:|------------:|---------:|------:|-----------:|---------:|------------:|
| –ú–∞—Å—Å–∏–≤–ü–æ–¥—Å—Ç—Ä–æ–∫   |        100 | false    |   79.07 us |  1,546.5 ns | 8.470 us | 1.768 |   75.92 us | 12,647.5 |    17.77 KB |
| –û–ø–µ—Ä–∞—Ç–æ—Ä–°–ª–æ–∂–µ–Ω–∏—è |        100 | true     |   44.76 us |    277.0 ns | 1.517 us |     1 |   44.28 us | 22,339.9 |    126.5 KB |
| –ú–∞—Å—Å–∏–≤–ü–æ–¥—Å—Ç—Ä–æ–∫   |      1,000 | false    |   731.8 us | 16,281.8 ns | 89.18 us | 0.564 |   692.9 us |  1,366.4 |    165.4 KB |
| –û–ø–µ—Ä–∞—Ç–æ—Ä–°–ª–æ–∂–µ–Ω–∏—è |      1,000 | true     | 1,303.4 us | 16,174.6 ns | 88.59 us |     1 | 1,260.5 us |    767.2 | 11,809.0 KB |

// –õ–µ–≥–µ–Ω–¥–∞
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ : –ó–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ'
Mean       : –ê—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ —Å—Ä–µ–¥–Ω–µ–µ –≤—Å–µ—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π
StdErr     : –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –≤—Å–µ—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π
StdDev     : –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π
Ratio      : –°—Ä–µ–¥–Ω–µ–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –æ—Ç–Ω–æ—à–µ–Ω–∏–π ([Mean] / [Baseline Mean])
Median     : –ó–Ω–∞—á–µ–Ω–∏–µ, —Ä–∞–∑–¥–µ–ª—è—é—â–µ–µ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è –Ω–∞ –¥–≤–µ —Ä–∞–≤–Ω—ã–µ —á–∞—Å—Ç–∏
Op/s       : –û–ø–µ—Ä–∞—Ü–∏–π –≤ —Å–µ–∫—É–Ω–¥—É
Allocated  : –í—ã–¥–µ–ª—è–µ–º–∞—è –ø–∞–º—è—Ç—å –Ω–∞ –æ–¥–Ω—É –æ–ø–µ—Ä–∞—Ü–∏—é
1 us       : 1 –ú–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥–∞
1 ns       : 1 –ù–∞–Ω–æ—Å–µ–∫—É–Ω–¥–∞
```
